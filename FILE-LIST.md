# 📦 StaticCrypt 自动加密系统 - 文件清单

## 🎯 已创建的文件

### 1. 核心配置文件

#### `.github/workflows/encrypt.yml`
- **作用**: GitHub Actions 自动化配置
- **功能**: 
  - 监听 `scr/` 目录的文件变化
  - 自动使用 StaticCrypt 加密页面
  - 使用自定义密码模板
  - 自动提交加密后的文件
- **触发条件**: 当 `scr/` 目录下的任何文件被修改并推送时

#### `.gitignore`
- **作用**: Git 忽略配置
- **功能**: 
  - 忽略 `scr/` 目录(源文件不提交,可选)
  - 忽略 `node_modules/` 等临时文件

#### `password-template.html`
- **作用**: StaticCrypt 自定义密码页面模板
- **功能**: 
  - 保持与你的设计风格一致的密码输入界面
  - 使用你的 DCP 设计系统(字体、颜色、样式)
  - 支持 ESC 键返回首页
  - 密码错误时显示动画提示

### 2. 本地工具

#### `encrypt-local.bat`
- **作用**: Windows 本地加密脚本
- **功能**: 
  - 一键加密所有页面
  - 用于本地测试
  - 无需等待 GitHub Actions

### 3. 文档

#### `README-ENCRYPT.md`
- **作用**: 完整的配置和使用文档
- **内容**: 
  - 目录结构说明
  - 初次设置步骤
  - 日常使用流程
  - 更新密码方法
  - 参数说明
  - 常见问题解答

#### `MIGRATION-GUIDE.md`
- **作用**: index.html 修改指南
- **内容**: 
  - 需要删除的代码清单
  - 修改前后对比
  - 验证修改的方法

#### `QUICKSTART.md`
- **作用**: 5 分钟快速开始指南
- **内容**: 
  - 分步骤操作说明
  - 命令行示例
  - 验证配置方法

---

## 📁 推荐的目录结构

```
github pages/
├── index.html                    # 公开页面(不加密)
├── project-finance.html          # 加密后的页面(自动生成,提交到 GitHub)
├── project-jaxx.html             # 加密后的页面(自动生成)
├── project-speed.html            # 加密后的页面(自动生成)
├── project-loan.html             # 加密后的页面(自动生成)
│
├── scr/                          # 源文件目录(未加密,可选择不提交)
│   ├── project-finance.html      # 原始文件,在这里编辑
│   ├── project-jaxx.html
│   ├── project-speed.html
│   └── project-loan.html
│
├── .github/
│   └── workflows/
│       └── encrypt.yml           # ✨ GitHub Actions 配置
│
├── password-template.html        # ✨ 自定义密码页面模板
├── encrypt-local.bat             # ✨ 本地加密脚本
├── .gitignore                    # ✨ Git 忽略配置
│
├── README-ENCRYPT.md             # ✨ 完整文档
├── MIGRATION-GUIDE.md            # ✨ 迁移指南
├── QUICKSTART.md                 # ✨ 快速开始
└── FILE-LIST.md                  # ✨ 本文件
```

---

## 🔄 工作流程图

```
┌─────────────────────────────────────────────────────────────┐
│  开发者本地操作                                              │
└─────────────────────────────────────────────────────────────┘
                          │
                          ▼
              编辑 scr/project-xxx.html
                          │
                          ▼
              git add scr/ && git commit && git push
                          │
                          ▼
┌─────────────────────────────────────────────────────────────┐
│  GitHub Actions 自动化                                       │
├─────────────────────────────────────────────────────────────┤
│  1. 检测到 scr/ 目录变化                                     │
│  2. 安装 Node.js 和 staticrypt                              │
│  3. 读取 GitHub Secret 中的密码                             │
│  4. 使用自定义模板加密所有页面                               │
│  5. 生成加密后的文件到根目录                                 │
│  6. 自动提交并推送                                          │
└─────────────────────────────────────────────────────────────┘
                          │
                          ▼
┌─────────────────────────────────────────────────────────────┐
│  GitHub Pages 部署                                          │
├─────────────────────────────────────────────────────────────┤
│  1. 自动部署更新后的页面                                     │
│  2. 用户访问时显示密码输入界面                               │
│  3. 输入正确密码后解密并显示内容                             │
└─────────────────────────────────────────────────────────────┘
```

---

## ✅ 关键问题解答

### Q1: 在 GitHub Secrets 里更新密码会自动更新吗?

**是的!** 工作流程:

1. 在 GitHub Secrets 中更新 `ENCRYPT_PASSWORD`
2. 修改任意 `scr/` 目录下的文件(哪怕只是加个空格)
3. 提交并推送
4. GitHub Actions 会读取**最新的** Secret 值
5. 使用新密码重新加密所有页面
6. 用户下次访问时需要输入新密码

### Q2: 监听文件更新时间还是内容变化?

**监听内容变化**(更准确):

```yaml
on:
  push:
    paths:
      - 'scr/**'  # 只要 scr 目录下任何文件的内容发生变化
```

GitHub Actions 无法直接监听文件修改时间,但监听内容变化更可靠:
- ✅ 文件内容改变 → 触发
- ✅ 新增文件 → 触发
- ✅ 删除文件 → 触发
- ❌ 只修改时间戳不改内容 → 不触发(这是合理的)

### Q3: 现有的密码弹窗怎么处理?

**三种方案:**

#### 方案 A: 完全替换(推荐)
- 删除 `index.html` 中的密码弹窗代码
- 直接跳转到加密页面
- StaticCrypt 接管密码验证
- **优点**: 代码简洁,真正的内容加密
- **缺点**: 失去你的自定义弹窗设计

#### 方案 B: 使用自定义模板(已实现)
- 删除 `index.html` 中的密码弹窗
- 使用 `password-template.html` 保持设计风格
- **优点**: 保持设计一致性,内容真正加密
- **缺点**: 需要维护模板文件

#### 方案 C: 双重验证(不推荐)
- 保留 `index.html` 中的密码弹窗
- 加上 StaticCrypt 加密
- **优点**: 双重保护
- **缺点**: 用户需要输入两次密码,体验差

**建议**: 使用方案 B,已经为你创建了 `password-template.html`

---

## 🎨 自定义密码页面

如果你想修改密码页面的样式,编辑 `password-template.html`:

```html
<!-- 修改标题 -->
<div class="pwd-title">// YOUR CUSTOM TITLE //</div>

<!-- 修改说明文字 -->
<div class="pwd-subtitle">
    你的自定义说明文字
</div>

<!-- 修改颜色变量 -->
<style>
    :root {
        --soul: #FF7B38;  /* 改成你喜欢的颜色 */
    }
</style>
```

---

## 🚀 立即开始

1. **阅读**: `QUICKSTART.md` (5 分钟快速开始)
2. **配置**: 按照步骤设置 GitHub Secret
3. **提交**: 推送配置文件到 GitHub
4. **测试**: 修改 `scr/` 目录下的文件并提交
5. **验证**: 访问你的 GitHub Pages 查看效果

---

## 📞 需要帮助?

- 完整文档: `README-ENCRYPT.md`
- 迁移指南: `MIGRATION-GUIDE.md`
- 快速开始: `QUICKSTART.md`

---

**祝你使用愉快! 🎉**
